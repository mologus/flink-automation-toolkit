{
  "4b2757789b9d3494d4757214d48d4df9": {
    "marketing.ddl": [
      "CREATE TABLE kafka_source (`id` STRING,`data` ROW<`amount` DECIMAL,`identification` STRING,`currency` STRING,`country` STRING ,`attribute` MAP<STRING,STRING>, `item` MAP<STRING,STRING>>,`specversion` STRING,`time` BIGINT,`source` STRING,`type`STRING, `ts` AS TO_TIMESTAMP(FROM_UNIXTIME(`time` / 1000)), WATERMARK FOR `ts` AS ts - INTERVAL '5' SECOND) WITH( 'connector' = 'kafka', 'topic' = 'dt_business_operation_events', 'properties.group.id' = 'competition_20250414_ts_group', 'property-version' = 'universal', 'properties.bootstrap.servers' = '192.168.10.125:9092', 'scan.startup.mode' = 'timestamp','scan.startup.mode' = 'latest-offset','format' = 'json')",
      "CREATE TABLE business_operation_events_sink ( `id` STRING, `identification` STRING, `amount` DECIMAL, `time` BIGINT, `tag` STRING, `uniqueCode` STRING, `type` STRING, PRIMARY KEY(identification) NOT ENFORCED ) WITH( 'connector' = 'upsert-kafka', 'topic' = 'dt_business_operation_events_sink', 'property-version' = 'universal', 'properties.bootstrap.servers' = '192.168.10.125:9092', 'key.format' = 'json', 'value.format' = 'json')",
      "CREATE TABLE business_operation_events_model_sink ( `identification` STRING, `id` STRING, `amount` DECIMAL, `amountType` INT, `tag` STRING, `time` BIGINT, `uniqueCode` STRING, `type` STRING, `action` INT, `periodKey` STRING, `currency` STRING,`sourceId` STRING,PRIMARY KEY(identification) NOT ENFORCED ) WITH( 'connector' = 'upsert-kafka', 'topic' = 'dt_business_operation_events_model_sink', 'property-version' = 'universal', 'properties.bootstrap.servers' = '192.168.10.125:9092', 'key.format' = 'json', 'value.format' = 'json')"
    ],
    "marketing.sql": [
      "INSERT INTO business_operation_events_model_sink SELECT data.attribute['roomId'] AS identification,CONCAT(LAST_VALUE(`id`),':','216') as id,sum(abs(amount)) as amount,1 as amountType,'216' as tag,LAST_VALUE(`time`),'competition_20250414_ts' as uniqueCode,LAST_VALUE(`type`) as type,1 as action,'20250408' as periodKey,LAST_VALUE(data.currency) as currency,data.identification as sourceId FROM (SELECT * from kafka_source where data.item['id'] in (1018,1025,1027,1004,1030) and data.attribute['roomId'] <> '' and data.attribute['roomId'] <> data.identification and type LIKE 'operation:pay:game:decrease' and `time` BETWEEN 1744070400000 and 1745971199999) GROUP BY  data.attribute['roomId'], data.identification",
      "INSERT INTO business_operation_events_sink SELECT CONCAT(LAST_VALUE(`id`),':','76',':','competition_20250414_ts') as id,data.identification as identification,SUM(abs(data.amount)) as amount,LAST_VALUE(`time`) as `time`,'76' as tag,'competition_20250414_ts' as uniqueCode,LAST_VALUE(`type`) as type from kafka_source where type = 'operation:pay:game:decrease' and  data.item['id'] in (1018,1025,1027,1004,1030) and `time` BETWEEN 1744070400000 and 1745971199999  GROUP BY data.identification",
      "INSERT INTO business_operation_events_sink SELECT CONCAT(LAST_VALUE(`id`),':','77',':','competition_20250414_ts') as id,data.attribute [ 'roomId' ] as identification,SUM(abs(data.amount)) as amount,LAST_VALUE(`time`) as `time`,'77' as tag,'competition_20250414_ts' as uniqueCode,LAST_VALUE(`type`) from kafka_source where type = 'operation:pay:game:decrease' and  data.item['id'] in (1018,1025,1027,1004,1030) and data.attribute [ 'roomId' ] <> '' and data.attribute [ 'roomId' ] <> data.identification and `time` BETWEEN 1744070400000 and 1745971199999  GROUP BY data.attribute [ 'roomId' ]"
    ],
    "pipeline.name": "competition_20250414_ts_task"
  },
  "b18d18538ef206192f7764c48c34a5a1": {
    "marketing.ddl": [
      "CREATE TABLE kafka_source (`id` STRING,`data` ROW<`amount` DECIMAL,`identification` STRING,`currency` STRING,`country` STRING ,`attribute` MAP<STRING,STRING>, `item` MAP<STRING,STRING>>,`specversion` STRING,`time` BIGINT,`source` STRING,`type`STRING, `ts` AS TO_TIMESTAMP(FROM_UNIXTIME(`time` / 1000)), WATERMARK FOR `ts` AS ts - INTERVAL '5' SECOND) WITH( 'connector' = 'kafka', 'topic' = 'business_operation_events', 'properties.group.id' = 'mega_20250410_group', 'property-version' = 'universal', 'properties.bootstrap.servers' = 'kafka-server:9092', 'scan.startup.mode' = 'latest-offset', 'format' = 'json')"
    ],
    "marketing.sql": [
      "INSERT INTO business_operation_events_model_sink SELECT data.identification as identification,CONCAT(LAST_VALUE(id),'1620') as id,sum(abs(amount)) as amount,1,'1620' as tag,LAST_VALUE(`time`) as `time`,'mega_20250410',LAST_VALUE(`type`) as type,1 as action,LAST_VALUE(periodKey) as periodKey,'bean' FROM (select *,FROM_UNIXTIME(`time` / 1000, 'yyyyMMdd') as periodKey from kafka_source where type LIKE 'operation:pay:game:decrease' and data.item['id'] = '1004' and `time` BETWEEN 1744156800000 and 1746057599999) GROUP BY data.identification,TUMBLE(`ts`, INTERVAL '1' DAY)"
    ],
    "pipeline.name": "mega_20250410_task"
  }
}
